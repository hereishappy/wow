<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #333;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            max-width: 1000px;
            width: 90%;
            min-height: 600px;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a6f);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
            font-size: 1.1rem;
        }

        input[type="text"], input[type="tel"], input[type="email"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus, input[type="tel"]:focus, input[type="email"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        .btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .video-container {
            position: relative;
            background: #000;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        #videoElement {
            width: 100%;
            height: 400px;
            object-fit: cover;
        }

        .ai-avatar {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff9a9e, #fecfef);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .question-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid #667eea;
        }

        .question-text {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
        }

        .question-counter {
            background: #667eea;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }

        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #28a745;
            animation: blink 1s infinite;
        }

        .status-dot.recording {
            background: #dc3545;
            animation: recordingPulse 1s infinite;
        }

        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0.3; }
        }

        @keyframes recordingPulse {
            0%, 100% { transform: scale(1); background: #dc3545; }
            50% { transform: scale(1.3); background: #ff6b6b; }
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;
        }

        .result-container {
            text-align: center;
            padding: 40px;
        }

        .result-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }

        .result-text {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: #333;
        }

        .permission-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            color: #856404;
        }

        .recording-timer {
            background: #dc3545;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 20px;
            display: none;
        }

        .ai-speaking {
            background: #17a2b8;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 20px;
            display: none;
        }

        @media (max-width: 768px) {
            .container {
                width: 95%;
                margin: 10px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .content {
                padding: 20px;
            }
            
            .ai-avatar {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è AI ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ</h1>
            <p>‡§ï‡§™‡•ç‡§≤‡•ã‡§ï ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§î‡§∞ ‡§ä‡§Ç‡§ö‡§æ‡§à ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç</p>
        </div>

        <div class="content">
            <!-- Registration Section -->
            <div class="section active" id="registration">
                <h2 style="text-align: center; margin-bottom: 30px; color: #333;">‡§â‡§Æ‡•ç‡§Æ‡•Ä‡§¶‡§µ‡§æ‡§∞ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£</h2>
                <form id="candidateForm">
                    <div class="form-group">
                        <label for="name">‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ *</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="mobile">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ *</label>
                        <input type="tel" id="mobile" name="mobile" required>
                    </div>
                    <div class="form-group">
                        <label for="email">‡§à‡§Æ‡•á‡§≤ ‡§Ü‡§à‡§°‡•Ä</label>
                        <input type="email" id="email" name="email">
                    </div>
                    <div class="form-group">
                        <label for="experience">‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§Ö‡§®‡•Å‡§≠‡§µ (‡§µ‡§∞‡•ç‡§∑‡•ã‡§Ç ‡§Æ‡•á‡§Ç)</label>
                        <input type="text" id="experience" name="experience" placeholder="‡§â‡§¶‡§æ‡§π‡§∞‡§£: 2 ‡§∏‡§æ‡§≤">
                    </div>
                    <div class="form-group">
                        <label for="location">‡§ï‡§æ‡§∞‡•ç‡§Ø ‡§∏‡•ç‡§•‡§æ‡§®</label>
                        <input type="text" id="location" name="location" placeholder="‡§â‡§¶‡§æ‡§π‡§∞‡§£: ‡§Æ‡•Å‡§Ç‡§¨‡§à, ‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä">
                    </div>
                    <div style="text-align: center;">
                        <button type="submit" class="btn">‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                    </div>
                </form>
            </div>

            <!-- Interview Section -->
            <div class="section" id="interview">
                <div class="permission-note">
                    <strong>‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£:</strong> ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ï‡•à‡§Æ‡§∞‡§æ ‡§î‡§∞ ‡§Æ‡§æ‡§á‡§ï‡•ç‡§∞‡•ã‡§´‡•ã‡§® ‡§ï‡•Ä ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç‡•§ ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ‡§®‡•á ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§ø‡§Ç‡§ó ‡§Ö‡§™‡§®‡•á ‡§Ü‡§™ ‡§∂‡•Å‡§∞‡•Ç ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                
                <div class="ai-speaking" id="aiSpeaking">
                    <span>üé§ AI ‡§™‡•ç‡§∞‡§∂‡•ç‡§® ‡§™‡•Ç‡§õ ‡§∞‡§π‡§æ ‡§π‡•à...</span>
                </div>
                
                <div class="recording-timer" id="recordingTimer">
                    <span>üî¥ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§ø‡§Ç‡§ó ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à - ‡§∏‡§Æ‡§Ø: <span id="timerDisplay">00:00</span></span>
                </div>
                
                <div class="video-container">
                    <video id="videoElement" autoplay muted></video>
                    <div class="ai-avatar">üë©‚Äçüè´</div>
                </div>
                
                <div class="question-container">
                    <div class="question-counter" id="questionCounter">‡§™‡•ç‡§∞‡§∂‡•ç‡§® 1/10</div>
                    <div class="question-text" id="questionText">‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§ú‡§æ‡§á‡§è...</div>
                </div>
                
                <div class="status-indicator" id="statusIndicator">
                    <div class="status-dot" id="statusDot"></div>
                    <span id="statusText">‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</span>
                </div>
                
                <div class="controls">
                    <button class="btn" id="startBtn" onclick="startInterview()">‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                    <button class="btn" id="nextBtn" onclick="nextQuestion()" style="display: none;">‡§Ö‡§ó‡§≤‡§æ ‡§™‡•ç‡§∞‡§∂‡•ç‡§®</button>
                    <button class="btn" id="stopRecordBtn" onclick="stopCurrentRecording()" style="display: none;">‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§ø‡§Ç‡§ó ‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
                </div>
            </div>

            <!-- Results Section -->
            <div class="section" id="results">
                <div class="result-container">
                    <div class="result-icon">üéâ</div>
                    <div class="result-text">‡§¨‡§ß‡§æ‡§à ‡§π‡•ã! ‡§Ü‡§™‡§ï‡§æ ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§™‡•Ç‡§∞‡§æ ‡§π‡•ã ‡§ó‡§Ø‡§æ ‡§π‡•à‡•§</div>
                    <p style="margin-bottom: 20px;">‡§Ü‡§™‡§ï‡•á ‡§ú‡§µ‡§æ‡§¨ Google Sheets ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§π‡•ã ‡§ó‡§è ‡§π‡•à‡§Ç‡•§ ‡§™‡§∞‡§ø‡§£‡§æ‡§Æ ‡§ú‡§≤‡•ç‡§¶ ‡§π‡•Ä ‡§Ü‡§™‡§ï‡•ã ‡§¨‡§§‡§æ‡§Ø‡§æ ‡§ú‡§æ‡§è‡§ó‡§æ‡•§</p>
                    <button class="btn" onclick="restartInterview()">‡§®‡§Ø‡§æ ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentQuestion = 0;
        let candidateData = {};
        let mediaRecorder;
        let recordedChunks = [];
        let isRecording = false;
        let stream;
        let interviewAnswers = [];
        let recordingTimer;
        let recordingStartTime;
        let currentSpeechUtterance;

        // Shuffled questions about Cuplok scaffolding and working at height
        const questions = [
            "‡§ï‡§™‡•ç‡§≤‡•ã‡§ï ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à ‡§î‡§∞ ‡§á‡§∏‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§ï‡§ø‡§Ø‡§æ ‡§ú‡§æ‡§§‡§æ ‡§π‡•à?",
            "‡§ä‡§Ç‡§ö‡§æ‡§à ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ï‡•å‡§® ‡§∏‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§â‡§™‡§æ‡§Ø ‡§Ö‡§™‡§®‡§æ‡§®‡•á ‡§ö‡§æ‡§π‡§ø‡§è?",
            "‡§ï‡§™‡•ç‡§≤‡•ã‡§ï ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§ï‡•á ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§ï‡§Ç‡§™‡•ã‡§®‡•á‡§Ç‡§ü ‡§ï‡•å‡§® ‡§∏‡•á ‡§π‡•à‡§Ç?",
            "‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§á‡§Ç‡§∏‡•ç‡§ü‡•â‡§≤ ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§ï‡§ø‡§® ‡§ö‡•Ä‡§ú‡•ã‡§Ç ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡§∞‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è?",
            "PPE (Personal Protective Equipment) ‡§Æ‡•á‡§Ç ‡§ï‡•å‡§® ‡§∏‡•á ‡§Ü‡§á‡§ü‡§Æ ‡§∂‡§æ‡§Æ‡§ø‡§≤ ‡§π‡•ã‡§§‡•á ‡§π‡•à‡§Ç?",
            "‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§ï‡§ø‡§§‡§®‡§æ ‡§µ‡§ú‡§® ‡§∞‡§ñ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç?",
            "‡§Ø‡§¶‡§ø ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§Æ‡•á‡§Ç ‡§ï‡•ã‡§à ‡§ï‡§Æ‡•Ä ‡§Ø‡§æ ‡§ñ‡§∞‡§æ‡§¨‡•Ä ‡§¶‡§ø‡§ñ‡•á ‡§§‡•ã ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è?",
            "‡§ï‡§™‡•ç‡§≤‡•ã‡§ï ‡§∏‡§ø‡§∏‡•ç‡§ü‡§Æ ‡§ï‡•Ä ‡§Æ‡§ú‡§¨‡•Ç‡§§‡•Ä ‡§ï‡•à‡§∏‡•á ‡§ö‡•á‡§ï ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç?",
            "‡§¨‡§æ‡§∞‡§ø‡§∂ ‡§Ø‡§æ ‡§§‡•á‡§ú ‡§π‡§µ‡§æ ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§™‡§∞ ‡§ï‡§æ‡§Æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è ‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç?",
            "‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§∏‡•á ‡§ó‡§ø‡§∞‡§®‡•á ‡§Ø‡§æ ‡§ö‡•ã‡§ü ‡§≤‡§ó‡§®‡•á ‡§™‡§∞ ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è?",
            "‡§ü‡§æ‡§à-‡§∞‡•â‡§°‡•ç‡§∏ ‡§î‡§∞ ‡§¨‡•ç‡§∞‡•á‡§∏‡§ø‡§Ç‡§ó ‡§ï‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§Æ‡§π‡§§‡•ç‡§µ ‡§π‡•à?",
            "Base plate ‡§î‡§∞ sole plate ‡§Æ‡•á‡§Ç ‡§ï‡•ç‡§Ø‡§æ ‡§Ö‡§Ç‡§§‡§∞ ‡§π‡•à?",
            "‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§ï‡•Ä ‡§∏‡§π‡•Ä height ‡§ï‡•à‡§∏‡•á maintain ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç?",
            "Ledger ‡§î‡§∞ transom ‡§ï‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§ï‡§æ‡§Æ ‡§π‡•à?",
            "Safety harness ‡§ï‡•à‡§∏‡•á ‡§™‡§π‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è?",
            "‡§ú‡§Æ‡•Ä‡§® ‡§ï‡•Ä ‡§ú‡§æ‡§Ç‡§ö ‡§ï‡•ç‡§Ø‡•ã‡§Ç ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à ‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§≤‡§ó‡§æ‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á?",
            "‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§™‡§∞ tools ‡§ï‡•à‡§∏‡•á ‡§∞‡§ñ‡§®‡•á ‡§ö‡§æ‡§π‡§ø‡§è?",
            "Fall arrest system ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
            "‡§∏‡•ç‡§ï‡•à‡§´‡•ã‡§≤‡•ç‡§°‡§ø‡§Ç‡§ó ‡§ï‡•ã ‡§ï‡•à‡§∏‡•á dismantle ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è?",
            "Emergency ‡§ï‡•á ‡§¶‡•å‡§∞‡§æ‡§® ‡§ï‡•à‡§∏‡•á ‡§ú‡§≤‡•ç‡§¶‡•Ä ‡§®‡•Ä‡§ö‡•á ‡§Ü‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è?"
        ];

        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Get 10 random questions
        const selectedQuestions = shuffleArray(questions).slice(0, 10);

        // Form submission
        document.getElementById('candidateForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            candidateData = {
                name: document.getElementById('name').value,
                mobile: document.getElementById('mobile').value,
                email: document.getElementById('email').value,
                experience: document.getElementById('experience').value,
                location: document.getElementById('location').value,
                timestamp: new Date().toISOString(),
                interviewId: 'INT_' + Date.now()
            };

            showSection('interview');
            setupCamera();
        });

        // Setup camera
        async function setupCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ 
                    video: true, 
                    audio: true 
                });
                
                const videoElement = document.getElementById('videoElement');
                videoElement.srcObject = stream;
                
                document.getElementById('statusText').textContent = '‡§ï‡•à‡§Æ‡§∞‡§æ ‡§§‡•à‡§Ø‡§æ‡§∞ ‡§π‡•à - ‡§á‡§Ç‡§ü‡§∞‡§µ‡•ç‡§Ø‡•Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç';
                document.getElementById('startBtn').style.display = 'block';
                
            } catch (err) {
                console.error('Camera access error:', err);
                document.getElementById('statusText').textContent = '‡§ï‡•à‡§Æ‡§∞‡§æ ‡§è‡§ï‡•ç‡§∏‡•á‡§∏ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ - ‡§ï‡•É‡§™‡§Ø‡§æ ‡§Ö‡§®‡•Å‡§Æ‡§§‡§ø ‡§¶‡•á‡§Ç';
            }
        }

        // Start interview
        function startInterview() {
            document.getElementById('startBtn').style.display = 'none';
            document.getElementById('nextBtn').style.display = 'block';
            document.getElementById('stopRecordBtn').style.display = 'block';
            
            currentQuestion = 0;
            showQuestion();
            updateProgress();
        }

        // Show current question
        function showQuestion() {
            if (currentQuestion < selectedQuestions.length) {
                document.getElementById('questionCounter').textContent = `‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${currentQuestion + 1}/10`;
                document.getElementById('questionText').textContent = selectedQuestions[currentQuestion];
                
                // Show AI speaking indicator
                document.getElementById('aiSpeaking').style.display = 'block';
                document.getElementById('recordingTimer').style.display = 'none';
                
                // Stop any ongoing recording
                if (isRecording) {
                    stopRecording();
                }
                
                // Speak question and auto-start recording
                speakQuestionAndRecord(selectedQuestions[currentQuestion]);
                
            } else {
                completeInterview();
            }
        }

        // Text-to-speech and auto-start recording
        function speakQuestionAndRecord(text) {
            if ('speechSynthesis' in window) {
                // Stop any ongoing speech
                window.speechSynthesis.cancel();
                
                currentSpeechUtterance = new SpeechSynthesisUtterance(text);
                currentSpeechUtterance.lang = 'hi-IN';
                currentSpeechUtterance.rate = 0.8;
                currentSpeechUtterance.pitch = 1.1;
                
                // Auto-start recording when speech ends
                currentSpeechUtterance.onend = function() {
                    document.getElementById('aiSpeaking').style.display = 'none';
                    setTimeout(() => {
                        startRecording();
                    }, 1000); // 1 second delay after speech ends
                };
                
                window.speechSynthesis.speak(currentSpeechUtterance);
            } else {
                // Fallback if TTS not supported
                document.getElementById('aiSpeaking').style.display = 'none';
                setTimeout(() => {
                    startRecording();
                }, 2000); // 2 seconds delay
            }
        }

        // Start recording
        function startRecording() {
            if (isRecording) return;
            
            recordedChunks = [];
            
            mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.ondataavailable = function(event) {
                if (event.data.size > 0) {
                    recordedChunks.push(event.data);
                }
            };
            
            mediaRecorder.onstop = function() {
                const blob = new Blob(recordedChunks, { type: 'video/webm' });
                console.log('Recording saved', blob);
                
                // Save answer data
                interviewAnswers.push({
                    questionNumber: currentQuestion + 1,
                    question: selectedQuestions[currentQuestion],
                    recordingBlob: blob,
                    recordingDuration: getRecordingDuration(),
                    timestamp: new Date().toISOString()
                });
            };
            
            mediaRecorder.start();
            isRecording = true;
            recordingStartTime = Date.now();
            
            // Show recording UI
            document.getElementById('recordingTimer').style.display = 'block';
            document.getElementById('statusText').textContent = '‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§ø‡§Ç‡§ó ‡§ö‡§≤ ‡§∞‡§π‡•Ä ‡§π‡•à - ‡§Ö‡§™‡§®‡§æ ‡§ú‡§µ‡§æ‡§¨ ‡§¶‡•á‡§Ç';
            document.getElementById('statusDot').classList.add('recording');
            
            // Start timer
            startRecordingTimer();
        }

        // Stop recording
        function stopRecording() {
            if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                mediaRecorder.stop();
                isRecording = false;
                
                // Hide recording UI
                document.getElementById('recordingTimer').style.display = 'none';
                document.getElementById('statusText').textContent = '‡§ú‡§µ‡§æ‡§¨ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§π‡•ã ‡§ó‡§Ø‡§æ';
                document.getElementById('statusDot').classList.remove('recording');
                
                // Stop timer
                if (recordingTimer) {
                    clearInterval(recordingTimer);
                }
            }
        }

        // Stop current recording manually
        function stopCurrentRecording() {
            if (isRecording) {
                stopRecording();
            }
        }

        // Start recording timer
        function startRecordingTimer() {
            recordingTimer = setInterval(() => {
                const elapsed = Date.now() - recordingStartTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        // Get recording duration
        function getRecordingDuration() {
            if (recordingStartTime) {
                return Date.now() - recordingStartTime;
            }
            return 0;
        }

        // Next question
        function nextQuestion() {
            if (isRecording) {
                stopRecording();
            }
            
            // Stop any ongoing speech
            if (window.speechSynthesis) {
                window.speechSynthesis.cancel();
            }
            
            currentQuestion++;
            showQuestion();
            updateProgress();
        }

        // Update progress bar
        function updateProgress() {
            const progress = ((currentQuestion + 1) / selectedQuestions.length) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Complete interview
        function completeInterview() {
            // Stop any ongoing recording
            if (isRecording) {
                stopRecording();
            }
            
            // Stop any ongoing speech
            if (window.speechSynthesis) {
                window.speechSynthesis.cancel();
            }
            
            // Save data to Google Sheets
            saveToGoogleSheets();
            
            // Stop camera
            if (stream) {
                stream.getTracks().forEach(track => track.stop());
            }
            
            showSection('results');
        }

        // Save to Google Sheets (placeholder)
        function saveToGoogleSheets() {
            const finalData = {
                candidate: candidateData,
                answers: interviewAnswers.map(answer => ({
                    questionNumber: answer.questionNumber,
                    question: answer.question,
                    recordingDuration: answer.recordingDuration,
                    timestamp: answer.timestamp
                })),
                completedAt: new Date().toISOString()
            };
            
            console.log('Data to save:', finalData);
        }

        // Show section
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');
        }

        // Restart interview
        function restartInterview() {
            location.reload();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Auto-Recording Scaffolding Interview App Initialized');
            console.log('Questions loaded:', selectedQuestions.length);
        });
    </script>
</body>
</html>